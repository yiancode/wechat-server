# 微信登录配置指南

配置完成后，用户可以通过扫描公众号二维码、发送消息获取验证码来登录 Yi-API。

## 配置清单

### 1. Yi-API 后台

**系统设置 → 配置 WeChat Server**

| 配置项 | 值 |
|--------|-----|
| WeChat Server 服务器地址 | `https://wx.example.com` |
| WeChat Server 访问凭证 | `your-api-token` |
| 微信公众号二维码图片链接 | （填入公众号二维码图片 URL） |

**系统设置 → 配置登录注册**

- [x] 允许通过微信登录 & 注册

---

### 2. 微信公众平台

| 配置项 | 值 |
|--------|-----|
| URL | `https://wx.example.com/wechat/{your-app-id}` |
| Token | `your-wechat-token` |
| EncodingAESKey | 随机生成 |
| 消息加解密方式 | 明文模式 |

---

## 用户登录流程

```
1. 用户访问 Yi-API 登录页面，选择"微信登录"
2. 页面显示公众号二维码
3. 用户扫码关注公众号
4. 用户向公众号发送任意消息
5. 公众号返回 6 位验证码（有效期 5 分钟）
6. 用户在登录页面输入验证码
7. 登录成功
```

---

## 测试验证

部署完成后，按以下顺序测试：

1. **服务健康检查**
   ```bash
   curl https://wx.example.com/health
   ```

2. **微信公众平台验证**
   - 提交服务器配置，验证通过后启用

3. **实际登录测试**
   - 访问 Yi-API 登录页面
   - 使用微信扫码登录
